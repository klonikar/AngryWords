<!DOCTYPE html>
<html>
<head profile="http://www.w3.org/2005/10/profile">
    <meta charset="UTF-8" />
    <!--meta name="viewport" content="width=device-width" /-->
    <meta name="viewport" content="user-scalable=no, initial-scale=0.7, maximum-scale=1, minimum-scale=0.7, width=device-width, height=device-height" />
    <!--meta name="viewport" content="user-scalable=yes, initial-scale=0.7, maximum-scale=0.7, minimum-scale=0.7, height=device-height, width=device-width, target-densitydpi=device-dpi" /-->
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <link rel="icon" type="image/png" href="images/favicon.png" />
	<title>Learn languages</title>
    <link href="css/bootstrap.min.css" rel="stylesheet">
	<link href="css/coverflow.css" rel="stylesheet" />
    <link href="css/mystyles.css" rel="stylesheet" >
    <!--link rel="stylesheet" type="text/css" href="css/index.css" /-->

</head>
<body>
  <nav class="navbar navbar-default" role="navigation">
   <div class="container-fluid">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
        <span class="sr-only"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">
        <li class="dropdown">
          <a href="#" class="dropdown-toggle languagesMenuItem" data-toggle="dropdown">Select a Language<span class="caret"></span></a>
          <ul class="dropdown-menu" role="menu">
            <li><a href="#" onclick='loadDevanagari()' class="languagesMenuItem" >&#x0926;&#x0947;&#x0935;&#x0928;&#x093e;&#x0917;&#x0930;&#x0940; (Devanagari, Hindi)</a></li>
            <li class="divider"></li>
            <li><a href="#" onclick='loadKannada()' class="languagesMenuItem" >&#x0c95;&#x0ca8;&#x0ccd;&#x0ca8;&#x0ca1; (Kannada)</a></li>
            <li class="divider"></li>
          </ul>
        </li>
        <li>
              <a class="btn btn-primary clearBtn" style="color:red;" href="index.html">2D</a>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle languagesMenuItem" data-toggle="dropdown">Pen Color<span class="caret"></span></a>
          <ul class="dropdown-menu" role="menu">
            <li><a href="#" onclick='ddlColour_onChange("#000000");' class="languagesMenuItem" style="color:#000000" >Black</a></li>
            <li><a href="#" onclick='ddlColour_onChange("#FF0000");' class="languagesMenuItem" style="color:#FF0000" >Red</a></li>
            <li><a href="#" onclick='ddlColour_onChange("#00FF00");' class="languagesMenuItem" style="color:#00FF00" >Green</a></li>
            <li><a href="#" onclick='ddlColour_onChange("#0000FF");' class="languagesMenuItem" style="color:#0000FF" >Blue</a></li>
            <li><a href="#" onclick='ddlColour_onChange("#FF55BB");' class="languagesMenuItem" style="color:#FF55BB" >Pink</a></li>
            <li><a href="#" onclick='ddlColour_onChange("purple");' class="languagesMenuItem" style="color:purple" >Purple</a></li>
            <li><a href="#" onclick='ddlColour_onChange("yellow");' class="languagesMenuItem" style="color:yellow" >Yellow</a></li>
            <li><a href="#" onclick='ddlColour_onChange("white");' class="languagesMenuItem" style="color:white;background-color:black" >White</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle languagesMenuItem" data-toggle="dropdown">Pen Width<span class="caret"></span></a>
          <ul class="dropdown-menu" role="menu">
            <li><a href="#" onclick='ddlLineWidth_onChange("1");' class="languagesMenuItem" >1</a></li>
            <li><a href="#" onclick='ddlLineWidth_onChange("3");' class="languagesMenuItem" >3</a></li>
            <li><a href="#" onclick='ddlLineWidth_onChange("5");' class="languagesMenuItem" >5</a></li>
            <li><a href="#" onclick='ddlLineWidth_onChange("10");' class="languagesMenuItem" >10</a></li>
          </ul>
        </li>
        <li>
              <a class="btn btn-primary clearBtn" href="#" onclick="btnClear_onClick();">Clear</a>
        </li>
      </ul>
    </div>
   </div>
  </nav>

	<div id="container">
    </div>

	<!--<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>-->
	<script src="js/coverflow.js"></script>
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="js/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="js/bootstrap.min.js"></script>
    <script type="text/javascript" src="js/utilFuncs.js"></script>
    <script type="text/javascript" src="js/languagesData.js"></script>
	<script>
	function reset(myplaylist) {

		coverflow('container').remove();
		
		coverflow('container').setup({
			width: '100%',
            height: (isIOSBrowser() ? 500 : 400),
			item: myplaylist.length/2,
			//mousewheel: false,
			//mode: "flash",
            backgroundcolor: "ffffff",
			//backgroundcolor: '009900',
			//backgroundopacity: 0,
			//wmode: 'transparent',
			//gradientcolor: 'ff0000',
			//showduration: true,
			//playlist: "playlist.json",
			//playlist: "http://api.flickr.com/services/feeds/groups_pool.gne?id=807213@N20&format=json&jsoncallback=?",
			//route: {
			// 	playlist: "items",
			// 	image: "media.m"
			//},
            playlist: myplaylist,
			coverwidth: 500,
			coverheight: (isIOSBrowser() ? 500 : 400),
			fixedsize: true,
			textoffset: 50,
			speed: 1.0
		})
		.on('ready', function() {
            coverflow().to(1);

			this.on('focus', function(index) {
				//document.getElementById('focusindex').innerHTML = index;
			});
			
			this.on('click', function(index, link) {
				//document.getElementById('clickindex').innerHTML = index;
				//console.log("link: ", link, "index: ", index);
				if (link) {
					//window.open(link, '_blank');
				}
			});
		});
	}

    function buildCardTitleElement(str, id, titleClass) {
        var elem = document.createElement('span');
        elem.className = titleClass;
        var elemText = document.createTextNode(str);
        elem.appendChild(elemText);
        elem.onclick = function(event) {
            var audio = document.getElementById("audio_" + id);
            if(audio) {
                if(isIOSBrowser() || isWindowsBrowser())
                    audio.load();
                //audio.play();
                playAudio(audio.id); // For cordova app
            }
            drawStringOnCanvas(str);
            return false;
        };
        return elem;
    }

    function buildImageFor(src, cardId, imgId, audioElem) {
            var img = document.createElement("img");
            img.src = src.i;
            img.className = "alphabetImage";
			var displayAltCaption = 0;
            img.onclick = function(evt) {
                var e = evt || event;
                if(isIOSBrowser() || isWindowsBrowser())
                    audioElem.load();
                //audioElem.play();
                playAudio(audioElem.id); // For cordova app
                drawStringOnCanvas(src.n.join(""));
				if(src.alt_n) {
                    // first set all alternate languages captions to display:none
                    for(var j in src.alt_n) {
                        if(!src.alt_n.hasOwnProperty(j))
                            continue;
                        document.getElementById("alt_caption_" + cardId + "_" + imgId + "_" + j).style.display = "none";
                    }

                    // then set the current alt caption or caption depending on the value of displayAltCaption
                    var altCaption = document.getElementById("alt_caption_" + cardId + "_" + imgId + "_" + displayAltCaption);
                    var caption = document.getElementById("caption_" + cardId + "_" + imgId);

                    if(displayAltCaption++ >= src.alt_n.length)
                        displayAltCaption = 0;

                    if(displayAltCaption > 0) {
                        altCaption.style.display = "";
                        caption.style.display = "none";
                    }
                    else {
                        caption.style.display = "";
                    }

				}
                e.preventDefault();
                return false;
            };
            // Listen for timeupdate event
            audioElem.addEventListener("timeupdate", function( e ) {
				var duration = audioElem.duration;
                if(isNaN(audioElem.duration))
                    duration = 1.0; // its highly unlikely to have audio clips of words longer than 1 second.
                
                var delta = duration/src.n.length;
                var intervalNo = parseInt(audioElem.currentTime/delta)+1;
                if(intervalNo*delta >= duration)
                    intervalNo--;
                //console.log( "audio timeupdate fired!", audioElem.currentTime, duration, intervalNo );
                for(var i in src.n) {
                    if(!src.n.hasOwnProperty(i))
                        continue;
                    var spanNo = parseInt(i)+1;
                    var spanId = "letter_audio_" + cardId + "_" + imgId + "_" + i;
                    var span = document.getElementById(spanId);
                    if(spanNo == intervalNo)
                        span.style.color = "red";
                    else
                        span.style.color = "yellow";
                }
            }, false);

            return img;
    }

    function buildCardForStr(str, id, audios, imagesAudio) {
        var div = document.createElement("div");
        div.className = "newsDivNoImage";
        var elem = buildCardTitleElement(str, id, "cardTitle");
        div.appendChild(elem);
        elem = buildCardTitleElement("", id, "cardTitlePadding");
        div.appendChild(elem);
        elem = buildCardTitleElement(str, id, "cardTitle");
        div.appendChild(elem);
        var table = document.createElement("table");
        //table.style.marginTop = "0px";
        var tbody = document.createElement("tbody");
        var tr = document.createElement("tr");
        for(var i in imagesAudio) {
            if(!imagesAudio.hasOwnProperty(i))
                continue;
            var audio = document.createElement("audio");
            audio.id = "audio_" + id + "_" + i;
            audio.controls = false;
            audio.style.height = "0px";
            for(var a in imagesAudio[i].a) {
                if(!imagesAudio[i].a.hasOwnProperty(a))
                    continue;
                var source = document.createElement("source");
                source.src = imagesAudio[i].a[a];
                source.type = "audio/" + source.src.substring(source.src.lastIndexOf(".")+1);
                audio.appendChild(source);
            }
            div.appendChild(audio);
            var img = buildImageFor(imagesAudio[i], id, i, audio);
            var td = document.createElement("td");
            td.appendChild(img);
            td.appendChild(document.createElement("br"));
			var caption = document.createElement("div");
			caption.id = "caption_" + id + "_" + i;
            for(var j in imagesAudio[i].n) {
                if(!imagesAudio[i].n.hasOwnProperty(j))
                    continue;
                var span = document.createElement("span");
                span.appendChild(document.createTextNode(imagesAudio[i].n[j]));
                span.id = "letter_audio_" + id + "_" + i + "_" + j;
                span.onclick = img.onclick;
                caption.appendChild(span);
            }
			td.appendChild(caption);
            if(imagesAudio[i].alt_n) {
                for(var j in imagesAudio[i].alt_n) {
                    if(!imagesAudio[i].alt_n.hasOwnProperty(j))
                        continue;
                    var alt_caption = document.createElement("div");
                    alt_caption.id = "alt_caption_" + id + "_" + i + "_" + j;
                    alt_caption.style.display = "none";
                    alt_caption.appendChild(document.createTextNode(imagesAudio[i].alt_n[j]));
                    td.appendChild(alt_caption);
                }
            }
            tr.appendChild(td);
        }
        tbody.appendChild(tr);
        table.appendChild(tbody);
        div.appendChild(table);
        var audio = document.createElement("audio");
        audio.id = "audio_" + id;
        audio.controls = false;
        for(var a in audios) {
            if(!audios.hasOwnProperty(a))
                continue;
            var source = document.createElement("source");
            source.src = audios[a];
            source.type = "audio/" + audios[a].substring(audios[a].lastIndexOf(".")+1);
            audio.appendChild(source);
        }
        div.appendChild(audio);
        var innerDiv = document.createElement("div");
        innerDiv.innerHTML = "";
        div.appendChild(innerDiv);
        var backgroundImage = null;

        return {bgImage: backgroundImage, domElement: div, link: null};
    }

    function loadData(data) {
        var myplaylist = [];
		var title = "";
		var description = "";
		var text = g_titleCardText;
		myplaylist[myplaylist.length] = {title: title, backgroundImage: null, text: text, description: description, duration: 500, link: null};
        for(var id in data) {
            if(!data.hasOwnProperty(id))
                continue;
            var domBg = buildCardForStr(data[id].k, parseInt(id)+1, data[id].a, data[id].i);
            myplaylist[myplaylist.length] = {title: "", backgroundImage: domBg.bgImage, domElement: domBg.domElement, description: "", duration: 500, link: domBg.link};
        }
        reset(myplaylist);
    }

    loadDevanagari();

	</script>
    <script type="text/javascript" src="js/scribble-util.js"></script>
    <script type="text/javascript" src="cordova.js"></script>
    <script type="text/javascript" src="js/index.js"></script>

<span class="instructionText"> Practice Letters here:</span>
<div>
    <canvas id="mainCanvas" width="750px" height="450px" style="border: 1px solid #000;"> </canvas>
</div>

<div style="display:none;width:480px;">
	<div style="float:right;">Focused: <b id="focusindex">0</b> | Clicked: <b id="clickindex">0</b></div>
	<p>
		<a href="javascript:;" onclick="coverflow().left();">Left</a> - <a href="javascript:;" onclick="coverflow().right();">Right</a>
	</p>
	<p>
		<a href="javascript:;" onclick="coverflow().prev();">Previous</a> - <a href="javascript:;" onclick="coverflow().next();">Next</a>
	</p>
	<p>
		<input id="toval" value="0" size="1"> <a href="javascript:;" onclick="coverflow().to(document.getElementById('toval').value);">To</a>
	</p>
	<p>
		<a href="javascript:;" onclick="coverflow().fadeIn(function(){console.log(900);});">Fade in</a> - <a href="javascript:;" onclick="coverflow().fadeOut();">Fade out</a>
	</p>
    <button onclick="reset();">Reset</button>
    <button onclick="coverflow().remove();">Remove</button>
</div>


</body>
</html>
